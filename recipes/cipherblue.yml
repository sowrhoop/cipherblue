name: cipherblue
description: "A Security & Privacy Focused Operating System For Desktops"
base-image: quay.io/fedora/fedora-silverblue
image-version: latest
modules:
    - type: rpm-ostree
      repos:
        - https://copr.fedorainfracloud.org/coprs/secureblue/hardened_malloc/repo/fedora-%OS_VERSION%/secureblue-hardened_malloc-fedora-%OS_VERSION%.repo
        - https://copr.fedorainfracloud.org/coprs/secureblue/run0edit/repo/fedora-%OS_VERSION%/secureblue-run0edit-fedora-%OS_VERSION%.repo
      install:
        - hardened_malloc
        - run0edit
        - usbguard
        - unbound
        - fapolicyd
    - type: script
      scripts:
        - httpsmirrors.sh
        - package-hardening.sh
        - cipherblue-cleanup.sh
        - selinux-hardening.sh
        - kernel-kargs.sh
    - type: rpm-ostree
      remove:
        - buildah
        - crun
        - dnf5
        - fedora-logos
        - fedora-logos-httpd
        - libdnf5
        - libdnf5-cli
        - sdbus-cpp
        - yajl
    - type: files
      files:
        - source: system/usr
          destination: /usr
        - source: system/etc
          destination: /etc
    - type: script
      scripts:
        - cipherblue-cleanup.sh
        - authselect-hardening.sh
        - permission-hardening.sh
        - systemd-hardening.sh
        - suid-hardening.sh
        - dconf-compile.sh
        - ima-setup.sh
    - type: cipherblue-signing
      source: local
